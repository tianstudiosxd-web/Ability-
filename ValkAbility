local player = game.Players.LocalPlayer
local UserInputService = game:GetService("UserInputService")
local RunService = game:GetService("RunService")

-- Variables
local currentSpeed = 16
local currentJumpHeight = 7.2
local infiniteJumpEnabled = false
local fastAttackEnabled = false
local attackSpeed = 0.1 -- Default attack delay (lower = faster)
local isMinimized = false
local currentCategory = "Movement"
local guiActive = true
local heartbeatConnection = nil
local attackConnection = nil

-- GUI Creation
local ScreenGui = Instance.new("ScreenGui")
local MainFrame = Instance.new("Frame")
local TopBar = Instance.new("Frame")
local TitleLabel = Instance.new("TextLabel")
local MinimizeButton = Instance.new("TextButton")
local ExitButton = Instance.new("TextButton")
local ContentFrame = Instance.new("Frame")

-- Left Side (Category Menu) - SCROLLABLE
local LeftFrame = Instance.new("ScrollingFrame")
local MovementButton = Instance.new("TextButton")
local CombatButton = Instance.new("TextButton")

-- Right Side (Content Area)
local RightFrame = Instance.new("ScrollingFrame")
local WalkspeedLabel = Instance.new("TextLabel")
local SpeedDisplay = Instance.new("TextLabel")
local MinusButton = Instance.new("TextButton")
local PlusButton = Instance.new("TextButton")

-- Jump Height Elements
local JumpHeightLabel = Instance.new("TextLabel")
local JumpHeightDisplay = Instance.new("TextLabel")
local JumpMinusButton = Instance.new("TextButton")
local JumpPlusButton = Instance.new("TextButton")

local InfiniteJumpLabel = Instance.new("TextLabel")
local InfiniteJumpButton = Instance.new("TextButton")

-- Fast Attack Elements
local FastAttackLabel = Instance.new("TextLabel")
local FastAttackButton = Instance.new("TextButton")
local AttackSpeedLabel = Instance.new("TextLabel")
local AttackSpeedDisplay = Instance.new("TextLabel")
local AttackMinusButton = Instance.new("TextButton")
local AttackPlusButton = Instance.new("TextButton")

local WarningLabel = Instance.new("TextLabel")
local MinimizedButton = Instance.new("TextButton")
local UICorner = Instance.new("UICorner")
local UIStroke = Instance.new("UIStroke")

-- Properties
ScreenGui.Name = "AbilityGUI"
ScreenGui.Parent = game.CoreGui
ScreenGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling

-- Main Frame
MainFrame.Name = "MainFrame"
MainFrame.Parent = ScreenGui
MainFrame.BackgroundColor3 = Color3.fromRGB(35, 35, 45)
MainFrame.BorderSizePixel = 0
MainFrame.Position = UDim2.new(0.5, -140, 0.5, -110)
MainFrame.Size = UDim2.new(0, 280, 0, 220)
MainFrame.Active = true
MainFrame.Draggable = true

local MainCorner = Instance.new("UICorner")
MainCorner.CornerRadius = UDim.new(0, 10)
MainCorner.Parent = MainFrame

-- Top Bar
TopBar.Name = "TopBar"
TopBar.Parent = MainFrame
TopBar.BackgroundColor3 = Color3.fromRGB(25, 25, 35)
TopBar.BorderSizePixel = 0
TopBar.Size = UDim2.new(1, 0, 0, 32)

local TopCorner = Instance.new("UICorner")
TopCorner.CornerRadius = UDim.new(0, 10)
TopCorner.Parent = TopBar

-- Title
TitleLabel.Name = "Title"
TitleLabel.Parent = TopBar
TitleLabel.BackgroundTransparency = 1
TitleLabel.Position = UDim2.new(0, 10, 0, 0)
TitleLabel.Size = UDim2.new(0.6, 0, 1, 0)
TitleLabel.Font = Enum.Font.GothamBold
TitleLabel.Text = "ValkHub - Utility"
TitleLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
TitleLabel.TextSize = 15
TitleLabel.TextXAlignment = Enum.TextXAlignment.Left

-- Minimize Button
MinimizeButton.Name = "MinimizeButton"
MinimizeButton.Parent = TopBar
MinimizeButton.BackgroundColor3 = Color3.fromRGB(255, 170, 0)
MinimizeButton.BorderSizePixel = 0
MinimizeButton.Position = UDim2.new(1, -60, 0.5, -9)
MinimizeButton.Size = UDim2.new(0, 23, 0, 18)
MinimizeButton.Font = Enum.Font.GothamBold
MinimizeButton.Text = "-"
MinimizeButton.TextColor3 = Color3.fromRGB(255, 255, 255)
MinimizeButton.TextSize = 16

local MinCorner = Instance.new("UICorner")
MinCorner.CornerRadius = UDim.new(0, 4)
MinCorner.Parent = MinimizeButton

-- Exit Button
ExitButton.Name = "ExitButton"
ExitButton.Parent = TopBar
ExitButton.BackgroundColor3 = Color3.fromRGB(255, 50, 50)
ExitButton.BorderSizePixel = 0
ExitButton.Position = UDim2.new(1, -32, 0.5, -9)
ExitButton.Size = UDim2.new(0, 23, 0, 18)
ExitButton.Font = Enum.Font.GothamBold
ExitButton.Text = "X"
ExitButton.TextColor3 = Color3.fromRGB(255, 255, 255)
ExitButton.TextSize = 13

local ExitCorner = Instance.new("UICorner")
ExitCorner.CornerRadius = UDim.new(0, 4)
ExitCorner.Parent = ExitButton

-- Content Frame
ContentFrame.Name = "ContentFrame"
ContentFrame.Parent = MainFrame
ContentFrame.BackgroundTransparency = 1
ContentFrame.Position = UDim2.new(0, 0, 0, 32)
ContentFrame.Size = UDim2.new(1, 0, 1, -32)

-- LEFT FRAME (Category Menu) - SCROLLABLE
LeftFrame.Name = "LeftFrame"
LeftFrame.Parent = ContentFrame
LeftFrame.BackgroundColor3 = Color3.fromRGB(30, 30, 40)
LeftFrame.BorderSizePixel = 0
LeftFrame.Position = UDim2.new(0, 0, 0, 0)
LeftFrame.Size = UDim2.new(0, 85, 1, 0)
LeftFrame.ScrollBarThickness = 3
LeftFrame.CanvasSize = UDim2.new(0, 0, 0, 0)
LeftFrame.ScrollBarImageColor3 = Color3.fromRGB(70, 255, 70)

local LeftCorner = Instance.new("UICorner")
LeftCorner.CornerRadius = UDim.new(0, 8)
LeftCorner.Parent = LeftFrame

-- UIListLayout for automatic positioning
local LeftListLayout = Instance.new("UIListLayout")
LeftListLayout.Parent = LeftFrame
LeftListLayout.SortOrder = Enum.SortOrder.LayoutOrder
LeftListLayout.Padding = UDim.new(0, 5)
LeftListLayout.HorizontalAlignment = Enum.HorizontalAlignment.Center

local LeftPadding = Instance.new("UIPadding")
LeftPadding.Parent = LeftFrame
LeftPadding.PaddingTop = UDim.new(0, 6)
LeftPadding.PaddingBottom = UDim.new(0, 6)
LeftPadding.PaddingLeft = UDim.new(0, 7)
LeftPadding.PaddingRight = UDim.new(0, 7)

-- Movement Category Button
MovementButton.Name = "MovementButton"
MovementButton.Parent = LeftFrame
MovementButton.BackgroundColor3 = Color3.fromRGB(70, 255, 70)
MovementButton.BorderSizePixel = 0
MovementButton.Size = UDim2.new(1, -14, 0, 28)
MovementButton.Font = Enum.Font.GothamBold
MovementButton.Text = "Movement"
MovementButton.TextColor3 = Color3.fromRGB(255, 255, 255)
MovementButton.TextSize = 10
MovementButton.LayoutOrder = 1

local MovementCorner = Instance.new("UICorner")
MovementCorner.CornerRadius = UDim.new(0, 5)
MovementCorner.Parent = MovementButton

-- Combat Category Button
CombatButton.Name = "CombatButton"
CombatButton.Parent = LeftFrame
CombatButton.BackgroundColor3 = Color3.fromRGB(120, 120, 130)
CombatButton.BorderSizePixel = 0
CombatButton.Size = UDim2.new(1, -14, 0, 28)
CombatButton.Font = Enum.Font.GothamBold
CombatButton.Text = "Combat"
CombatButton.TextColor3 = Color3.fromRGB(255, 255, 255)
CombatButton.TextSize = 10
CombatButton.LayoutOrder = 2

local CombatCorner = Instance.new("UICorner")
CombatCorner.CornerRadius = UDim.new(0, 5)
CombatCorner.Parent = CombatButton

-- Auto-update CanvasSize for LeftFrame
LeftListLayout:GetPropertyChangedSignal("AbsoluteContentSize"):Connect(function()
    LeftFrame.CanvasSize = UDim2.new(0, 0, 0, LeftListLayout.AbsoluteContentSize.Y + 12)
end)

-- RIGHT FRAME (Content Area)
RightFrame.Name = "RightFrame"
RightFrame.Parent = ContentFrame
RightFrame.BackgroundColor3 = Color3.fromRGB(40, 40, 50)
RightFrame.BorderSizePixel = 0
RightFrame.Position = UDim2.new(0, 90, 0, 0)
RightFrame.Size = UDim2.new(1, -90, 1, 0)
RightFrame.ScrollBarThickness = 3
RightFrame.CanvasSize = UDim2.new(0, 0, 0, 250)
RightFrame.ScrollBarImageColor3 = Color3.fromRGB(70, 255, 70)

local RightCorner = Instance.new("UICorner")
RightCorner.CornerRadius = UDim.new(0, 8)
RightCorner.Parent = RightFrame

-- Walkspeed Label
WalkspeedLabel.Name = "WalkspeedLabel"
WalkspeedLabel.Parent = RightFrame
WalkspeedLabel.BackgroundTransparency = 1
WalkspeedLabel.Position = UDim2.new(0, 10, 0, 8)
WalkspeedLabel.Size = UDim2.new(0, 100, 0, 18)
WalkspeedLabel.Font = Enum.Font.Gotham
WalkspeedLabel.Text = "Walkspeed:"
WalkspeedLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
WalkspeedLabel.TextSize = 12
WalkspeedLabel.TextXAlignment = Enum.TextXAlignment.Left

-- Speed Display
SpeedDisplay.Name = "SpeedDisplay"
SpeedDisplay.Parent = RightFrame
SpeedDisplay.BackgroundColor3 = Color3.fromRGB(45, 45, 55)
SpeedDisplay.BorderSizePixel = 0
SpeedDisplay.Position = UDim2.new(0, 10, 0, 28)
SpeedDisplay.Size = UDim2.new(0, 50, 0, 26)
SpeedDisplay.Font = Enum.Font.Gotham
SpeedDisplay.Text = tostring(currentSpeed)
SpeedDisplay.TextColor3 = Color3.fromRGB(255, 255, 255)
SpeedDisplay.TextSize = 14

local SpeedCorner = Instance.new("UICorner")
SpeedCorner.CornerRadius = UDim.new(0, 5)
SpeedCorner.Parent = SpeedDisplay

-- Minus Button (Walkspeed)
MinusButton.Name = "MinusButton"
MinusButton.Parent = RightFrame
MinusButton.BackgroundColor3 = Color3.fromRGB(255, 70, 70)
MinusButton.BorderSizePixel = 0
MinusButton.Position = UDim2.new(0, 65, 0, 28)
MinusButton.Size = UDim2.new(0, 28, 0, 26)
MinusButton.Font = Enum.Font.GothamBold
MinusButton.Text = "-"
MinusButton.TextColor3 = Color3.fromRGB(255, 255, 255)
MinusButton.TextSize = 18

local MinusCorner = Instance.new("UICorner")
MinusCorner.CornerRadius = UDim.new(0, 5)
MinusCorner.Parent = MinusButton

-- Plus Button (Walkspeed)
PlusButton.Name = "PlusButton"
PlusButton.Parent = RightFrame
PlusButton.BackgroundColor3 = Color3.fromRGB(70, 255, 70)
PlusButton.BorderSizePixel = 0
PlusButton.Position = UDim2.new(0, 98, 0, 28)
PlusButton.Size = UDim2.new(0, 28, 0, 26)
PlusButton.Font = Enum.Font.GothamBold
PlusButton.Text = "+"
PlusButton.TextColor3 = Color3.fromRGB(255, 255, 255)
PlusButton.TextSize = 18

local PlusCorner = Instance.new("UICorner")
PlusCorner.CornerRadius = UDim.new(0, 5)
PlusCorner.Parent = PlusButton

-- Jump Height Label
JumpHeightLabel.Name = "JumpHeightLabel"
JumpHeightLabel.Parent = RightFrame
JumpHeightLabel.BackgroundTransparency = 1
JumpHeightLabel.Position = UDim2.new(0, 10, 0, 62)
JumpHeightLabel.Size = UDim2.new(0, 100, 0, 18)
JumpHeightLabel.Font = Enum.Font.Gotham
JumpHeightLabel.Text = "Jump Height:"
JumpHeightLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
JumpHeightLabel.TextSize = 12
JumpHeightLabel.TextXAlignment = Enum.TextXAlignment.Left

-- Jump Height Display
JumpHeightDisplay.Name = "JumpHeightDisplay"
JumpHeightDisplay.Parent = RightFrame
JumpHeightDisplay.BackgroundColor3 = Color3.fromRGB(45, 45, 55)
JumpHeightDisplay.BorderSizePixel = 0
JumpHeightDisplay.Position = UDim2.new(0, 10, 0, 82)
JumpHeightDisplay.Size = UDim2.new(0, 50, 0, 26)
JumpHeightDisplay.Font = Enum.Font.Gotham
JumpHeightDisplay.Text = tostring(currentJumpHeight)
JumpHeightDisplay.TextColor3 = Color3.fromRGB(255, 255, 255)
JumpHeightDisplay.TextSize = 14

local JumpHeightCorner = Instance.new("UICorner")
JumpHeightCorner.CornerRadius = UDim.new(0, 5)
JumpHeightCorner.Parent = JumpHeightDisplay

-- Jump Minus Button
JumpMinusButton.Name = "JumpMinusButton"
JumpMinusButton.Parent = RightFrame
JumpMinusButton.BackgroundColor3 = Color3.fromRGB(255, 70, 70)
JumpMinusButton.BorderSizePixel = 0
JumpMinusButton.Position = UDim2.new(0, 65, 0, 82)
JumpMinusButton.Size = UDim2.new(0, 28, 0, 26)
JumpMinusButton.Font = Enum.Font.GothamBold
JumpMinusButton.Text = "-"
JumpMinusButton.TextColor3 = Color3.fromRGB(255, 255, 255)
JumpMinusButton.TextSize = 18

local JumpMinusCorner = Instance.new("UICorner")
JumpMinusCorner.CornerRadius = UDim.new(0, 5)
JumpMinusCorner.Parent = JumpMinusButton

-- Jump Plus Button
JumpPlusButton.Name = "JumpPlusButton"
JumpPlusButton.Parent = RightFrame
JumpPlusButton.BackgroundColor3 = Color3.fromRGB(70, 255, 70)
JumpPlusButton.BorderSizePixel = 0
JumpPlusButton.Position = UDim2.new(0, 98, 0, 82)
JumpPlusButton.Size = UDim2.new(0, 28, 0, 26)
JumpPlusButton.Font = Enum.Font.GothamBold
JumpPlusButton.Text = "+"
JumpPlusButton.TextColor3 = Color3.fromRGB(255, 255, 255)
JumpPlusButton.TextSize = 18

local JumpPlusCorner = Instance.new("UICorner")
JumpPlusCorner.CornerRadius = UDim.new(0, 5)
JumpPlusCorner.Parent = JumpPlusButton

-- Infinite Jump Label
InfiniteJumpLabel.Name = "InfiniteJumpLabel"
InfiniteJumpLabel.Parent = RightFrame
InfiniteJumpLabel.BackgroundTransparency = 1
InfiniteJumpLabel.Position = UDim2.new(0, 10, 0, 116)
InfiniteJumpLabel.Size = UDim2.new(0, 100, 0, 18)
InfiniteJumpLabel.Font = Enum.Font.Gotham
InfiniteJumpLabel.Text = "Infinite Jump:"
InfiniteJumpLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
InfiniteJumpLabel.TextSize = 12
InfiniteJumpLabel.TextXAlignment = Enum.TextXAlignment.Left

-- Infinite Jump Button
InfiniteJumpButton.Name = "InfiniteJumpButton"
InfiniteJumpButton.Parent = RightFrame
InfiniteJumpButton.BackgroundColor3 = Color3.fromRGB(255, 70, 70)
InfiniteJumpButton.BorderSizePixel = 0
InfiniteJumpButton.Position = UDim2.new(0, 10, 0, 136)
InfiniteJumpButton.Size = UDim2.new(0, 55, 0, 26)
InfiniteJumpButton.Font = Enum.Font.Gotham
InfiniteJumpButton.Text = "OFF"
InfiniteJumpButton.TextColor3 = Color3.fromRGB(255, 255, 255)
InfiniteJumpButton.TextSize = 12

local JumpCorner = Instance.new("UICorner")
JumpCorner.CornerRadius = UDim.new(0, 5)
JumpCorner.Parent = InfiniteJumpButton

-- ========== FAST ATTACK ELEMENTS ==========
-- Fast Attack Label
FastAttackLabel.Name = "FastAttackLabel"
FastAttackLabel.Parent = RightFrame
FastAttackLabel.BackgroundTransparency = 1
FastAttackLabel.Position = UDim2.new(0, 10, 0, 8)
FastAttackLabel.Size = UDim2.new(0, 100, 0, 18)
FastAttackLabel.Font = Enum.Font.Gotham
FastAttackLabel.Text = "Fast Attack:"
FastAttackLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
FastAttackLabel.TextSize = 12
FastAttackLabel.TextXAlignment = Enum.TextXAlignment.Left
FastAttackLabel.Visible = false

-- Fast Attack Button
FastAttackButton.Name = "FastAttackButton"
FastAttackButton.Parent = RightFrame
FastAttackButton.BackgroundColor3 = Color3.fromRGB(255, 70, 70)
FastAttackButton.BorderSizePixel = 0
FastAttackButton.Position = UDim2.new(0, 10, 0, 28)
FastAttackButton.Size = UDim2.new(0, 55, 0, 26)
FastAttackButton.Font = Enum.Font.Gotham
FastAttackButton.Text = "OFF"
FastAttackButton.TextColor3 = Color3.fromRGB(255, 255, 255)
FastAttackButton.TextSize = 12
FastAttackButton.Visible = false

local FastAttackCorner = Instance.new("UICorner")
FastAttackCorner.CornerRadius = UDim.new(0, 5)
FastAttackCorner.Parent = FastAttackButton

-- Attack Speed Label
AttackSpeedLabel.Name = "AttackSpeedLabel"
AttackSpeedLabel.Parent = RightFrame
AttackSpeedLabel.BackgroundTransparency = 1
AttackSpeedLabel.Position = UDim2.new(0, 10, 0, 62)
AttackSpeedLabel.Size = UDim2.new(0, 100, 0, 18)
AttackSpeedLabel.Font = Enum.Font.Gotham
AttackSpeedLabel.Text = "Attack Speed:"
AttackSpeedLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
AttackSpeedLabel.TextSize = 12
AttackSpeedLabel.TextXAlignment = Enum.TextXAlignment.Left
AttackSpeedLabel.Visible = false

-- Attack Speed Display
AttackSpeedDisplay.Name = "AttackSpeedDisplay"
AttackSpeedDisplay.Parent = RightFrame
AttackSpeedDisplay.BackgroundColor3 = Color3.fromRGB(45, 45, 55)
AttackSpeedDisplay.BorderSizePixel = 0
AttackSpeedDisplay.Position = UDim2.new(0, 10, 0, 82)
AttackSpeedDisplay.Size = UDim2.new(0, 50, 0, 26)
AttackSpeedDisplay.Font = Enum.Font.Gotham
AttackSpeedDisplay.Text = tostring(attackSpeed)
AttackSpeedDisplay.TextColor3 = Color3.fromRGB(255, 255, 255)
AttackSpeedDisplay.TextSize = 14
AttackSpeedDisplay.Visible = false

local AttackSpeedCorner = Instance.new("UICorner")
AttackSpeedCorner.CornerRadius = UDim.new(0, 5)
AttackSpeedCorner.Parent = AttackSpeedDisplay

-- Attack Minus Button
AttackMinusButton.Name = "AttackMinusButton"
AttackMinusButton.Parent = RightFrame
AttackMinusButton.BackgroundColor3 = Color3.fromRGB(255, 70, 70)
AttackMinusButton.BorderSizePixel = 0
AttackMinusButton.Position = UDim2.new(0, 65, 0, 82)
AttackMinusButton.Size = UDim2.new(0, 28, 0, 26)
AttackMinusButton.Font = Enum.Font.GothamBold
AttackMinusButton.Text = "-"
AttackMinusButton.TextColor3 = Color3.fromRGB(255, 255, 255)
AttackMinusButton.TextSize = 18
AttackMinusButton.Visible = false

local AttackMinusCorner = Instance.new("UICorner")
AttackMinusCorner.CornerRadius = UDim.new(0, 5)
AttackMinusCorner.Parent = AttackMinusButton

-- Attack Plus Button
AttackPlusButton.Name = "AttackPlusButton"
AttackPlusButton.Parent = RightFrame
AttackPlusButton.BackgroundColor3 = Color3.fromRGB(70, 255, 70)
AttackPlusButton.BorderSizePixel = 0
AttackPlusButton.Position = UDim2.new(0, 98, 0, 82)
AttackPlusButton.Size = UDim2.new(0, 28, 0, 26)
AttackPlusButton.Font = Enum.Font.GothamBold
AttackPlusButton.Text = "+"
AttackPlusButton.TextColor3 = Color3.fromRGB(255, 255, 255)
AttackPlusButton.TextSize = 18
AttackPlusButton.Visible = false

local AttackPlusCorner = Instance.new("UICorner")
AttackPlusCorner.CornerRadius = UDim.new(0, 5)
AttackPlusCorner.Parent = AttackPlusButton

-- Warning Label
WarningLabel.Name = "WarningLabel"
WarningLabel.Parent = RightFrame
WarningLabel.BackgroundTransparency = 1
WarningLabel.Position = UDim2.new(0, 10, 0, 220)
WarningLabel.Size = UDim2.new(1, -20, 0, 16)
WarningLabel.Font = Enum.Font.Gotham
WarningLabel.Text = ""
WarningLabel.TextColor3 = Color3.fromRGB(255, 100, 100)
WarningLabel.TextSize = 10
WarningLabel.Visible = false

-- Minimized Button (RGB Border)
MinimizedButton.Name = "MinimizedButton"
MinimizedButton.Parent = ScreenGui
MinimizedButton.BackgroundColor3 = Color3.fromRGB(35, 35, 45)
MinimizedButton.BorderSizePixel = 0
MinimizedButton.Position = UDim2.new(0.5, -60, 0, 10)
MinimizedButton.Size = UDim2.new(0, 120, 0, 40)
MinimizedButton.Font = Enum.Font.GothamBold
MinimizedButton.Text = "ValkHub"
MinimizedButton.TextColor3 = Color3.fromRGB(255, 255, 255)
MinimizedButton.TextSize = 16
MinimizedButton.Visible = false
MinimizedButton.Active = true
MinimizedButton.Draggable = true

UICorner.CornerRadius = UDim.new(0, 8)
UICorner.Parent = MinimizedButton

UIStroke.Thickness = 2
UIStroke.Parent = MinimizedButton

-- RGB Animation
spawn(function()
    while true do
        for hue = 0, 1, 0.01 do
            UIStroke.Color = Color3.fromHSV(hue, 1, 1)
            wait(0.03)
        end
    end
end)

-- Functions
local function updateSpeed()
    SpeedDisplay.Text = tostring(currentSpeed)
end

local function updateJumpHeight()
    JumpHeightDisplay.Text = tostring(currentJumpHeight)
end

local function updateAttackSpeed()
    AttackSpeedDisplay.Text = tostring(attackSpeed)
end

local function showWarning(message)
    WarningLabel.Text = message
    WarningLabel.Visible = true
    wait(2)
    WarningLabel.Visible = false
end

local function switchCategory(category)
    currentCategory = category
    
    -- Reset all button colors
    MovementButton.BackgroundColor3 = Color3.fromRGB(120, 120, 130)
    CombatButton.BackgroundColor3 = Color3.fromRGB(120, 120, 130)
    
    -- Hide all content
    WalkspeedLabel.Visible = false
    SpeedDisplay.Visible = false
    MinusButton.Visible = false
    PlusButton.Visible = false
    JumpHeightLabel.Visible = false
    JumpHeightDisplay.Visible = false
    JumpMinusButton.Visible = false
    JumpPlusButton.Visible = false
    InfiniteJumpLabel.Visible = false
    InfiniteJumpButton.Visible = false
    
    FastAttackLabel.Visible = false
    FastAttackButton.Visible = false
    AttackSpeedLabel.Visible = false
    AttackSpeedDisplay.Visible = false
    AttackMinusButton.Visible = false
    AttackPlusButton.Visible = false
    
    -- Show selected category
    if category == "Movement" then
        MovementButton.BackgroundColor3 = Color3.fromRGB(70, 255, 70)
        WalkspeedLabel.Visible = true
        SpeedDisplay.Visible = true
        MinusButton.Visible = true
        PlusButton.Visible = true
        JumpHeightLabel.Visible = true
        JumpHeightDisplay.Visible = true
        JumpMinusButton.Visible = true
        JumpPlusButton.Visible = true
        InfiniteJumpLabel.Visible = true
        InfiniteJumpButton.Visible = true
    elseif category == "Combat" then
        CombatButton.BackgroundColor3 = Color3.fromRGB(70, 255, 70)
        FastAttackLabel.Visible = true
        FastAttackButton.Visible = true
        AttackSpeedLabel.Visible = true
        AttackSpeedDisplay.Visible = true
        AttackMinusButton.Visible = true
        AttackPlusButton.Visible = true
    end
end

-- Fast Attack Function
local function startFastAttack()
    if attackConnection then
        attackConnection:Disconnect()
    end
    
    attackConnection = RunService.Heartbeat:Connect(function()
        if fastAttackEnabled and guiActive then
            local character = player.Character
            if character then
                local tool = character:FindFirstChildOfClass("Tool")
                if tool and tool:FindFirstChild("Handle") then
                    -- Try to activate the tool
                    tool:Activate()
                    wait(attackSpeed)
                end
            end
        end
    end)
end
-- Reset all abilities to default
local function resetAllAbilities()
    guiActive = false
    
    -- Reset walkspeed to default
    local character = player.Character
    if character then
        local humanoid = character:FindFirstChild("Humanoid")
        if humanoid then
            humanoid.WalkSpeed = 16
            humanoid.JumpHeight = 7.2
        end
    end
    
    -- Disable infinite jump and fast attack
    infiniteJumpEnabled = false
    fastAttackEnabled = false
    
    -- Disconnect all connections
    if heartbeatConnection then
        heartbeatConnection:Disconnect()
        heartbeatConnection = nil
    end
    
    if attackConnection then
        attackConnection:Disconnect()
        attackConnection = nil
    end
    
    print("All abilities disabled!")
end

-- Auto Apply Walkspeed & Jump Height
heartbeatConnection = RunService.Heartbeat:Connect(function()
    if guiActive then
        local character = player.Character
        if character then
            local humanoid = character:FindFirstChild("Humanoid")
            if humanoid then
                if humanoid.WalkSpeed ~= currentSpeed then
                    humanoid.WalkSpeed = currentSpeed
                end
                if humanoid.JumpHeight ~= currentJumpHeight then
                    humanoid.JumpHeight = currentJumpHeight
                end
            end
        end
    end
end)

-- Button Functions
MovementButton.MouseButton1Click:Connect(function()
    switchCategory("Movement")
end)

CombatButton.MouseButton1Click:Connect(function()
    switchCategory("Combat")
end)

-- Walkspeed Buttons
PlusButton.MouseButton1Click:Connect(function()
    if currentSpeed < 100 then
        currentSpeed = currentSpeed + 1
        updateSpeed()
    else
        showWarning("Walkspeed cannot be more than 100")
    end
end)

MinusButton.MouseButton1Click:Connect(function()
    if currentSpeed > 1 then
        currentSpeed = currentSpeed - 1
        updateSpeed()
    end
end)

-- Jump Height Buttons
JumpPlusButton.MouseButton1Click:Connect(function()
    if currentJumpHeight < 50 then
        currentJumpHeight = math.floor((currentJumpHeight + 0.5) * 10 + 0.5) / 10
        updateJumpHeight()
    else
        showWarning("Jump Height cannot be more than 50")
    end
end)

JumpMinusButton.MouseButton1Click:Connect(function()
    if currentJumpHeight > 1 then
        currentJumpHeight = math.floor((currentJumpHeight - 0.5) * 10 + 0.5) / 10
        updateJumpHeight()
    end
end)

-- Infinite Jump Button
InfiniteJumpButton.MouseButton1Click:Connect(function()
    infiniteJumpEnabled = not infiniteJumpEnabled
    if infiniteJumpEnabled then
        InfiniteJumpButton.Text = "ON"
        InfiniteJumpButton.BackgroundColor3 = Color3.fromRGB(70, 255, 70)
    else
        InfiniteJumpButton.Text = "OFF"
        InfiniteJumpButton.BackgroundColor3 = Color3.fromRGB(255, 70, 70)
    end
end)

-- Fast Attack Button
FastAttackButton.MouseButton1Click:Connect(function()
    fastAttackEnabled = not fastAttackEnabled
    if fastAttackEnabled then
        FastAttackButton.Text = "ON"
        FastAttackButton.BackgroundColor3 = Color3.fromRGB(70, 255, 70)
        startFastAttack()
        print("Fast Attack Enabled!")
    else
        FastAttackButton.Text = "OFF"
        FastAttackButton.BackgroundColor3 = Color3.fromRGB(255, 70, 70)
        if attackConnection then
            attackConnection:Disconnect()
            attackConnection = nil
        end
        print("Fast Attack Disabled!")
    end
end)

-- Attack Speed Buttons
AttackPlusButton.MouseButton1Click:Connect(function()
    if attackSpeed < 1 then
        attackSpeed = math.floor((attackSpeed + 0.05) * 100 + 0.5) / 100
        updateAttackSpeed()
        if fastAttackEnabled then
            startFastAttack()
        end
    else
        showWarning("Attack Speed cannot be more than 1.0")
    end
end)

AttackMinusButton.MouseButton1Click:Connect(function()
    if attackSpeed > 0.01 then
        attackSpeed = math.floor((attackSpeed - 0.05) * 100 + 0.5) / 100
        updateAttackSpeed()
        if fastAttackEnabled then
            startFastAttack()
        end
    else
        showWarning("Attack Speed cannot be less than 0.01")
    end
end)

-- Minimize Button
MinimizeButton.MouseButton1Click:Connect(function()
    isMinimized = not isMinimized
    MainFrame.Visible = not isMinimized
    MinimizedButton.Visible = isMinimized
    print("GUI Minimized - Features still active!")
end)

MinimizedButton.MouseButton1Click:Connect(function()
    isMinimized = false
    MainFrame.Visible = true
    MinimizedButton.Visible = false
    print("GUI Restored!")
end)

-- Exit Button
ExitButton.MouseButton1Click:Connect(function()
    resetAllAbilities()
    ScreenGui:Destroy()
    print("GUI Closed - All features disabled!")
end)

-- Infinite Jump Logic
UserInputService.JumpRequest:Connect(function()
    if guiActive and infiniteJumpEnabled then
        local character = player.Character
        if character then
            local humanoid = character:FindFirstChild("Humanoid")
            if humanoid then
                humanoid:ChangeState(Enum.HumanoidStateType.Jumping)
            end
        end
    end
end)

-- Character Reset Handler
player.CharacterAdded:Connect(function(character)
    if guiActive then
        local humanoid = character:WaitForChild("Humanoid")
        wait(0.1)
        humanoid.WalkSpeed = currentSpeed
        humanoid.JumpHeight = currentJumpHeight
        
        -- Restart fast attack if enabled
        if fastAttackEnabled then
            startFastAttack()
        end
    else
        local humanoid = character:WaitForChild("Humanoid")
        wait(0.1)
        humanoid.WalkSpeed = 16
        humanoid.JumpHeight = 7.2
    end
end)
